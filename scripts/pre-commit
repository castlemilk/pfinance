#!/bin/bash

# Pre-commit hook for PFinance
# Fast lint/format check only (~3s)

echo "ğŸ” Running pre-commit checks..."

# Check Go formatting
GOFMT_OUTPUT=$(cd backend && gofmt -l . 2>/dev/null)
if [ -n "$GOFMT_OUTPUT" ]; then
  echo "âŒ Go files not formatted:"
  echo "$GOFMT_OUTPUT"
  echo "Run 'cd backend && go fmt ./...' to fix"
  exit 1
fi

# Check Go vet
cd backend && go vet ./... 2>&1
if [ $? -ne 0 ]; then
  echo "âŒ go vet failed"
  exit 1
fi
cd ..

echo "âœ… Pre-commit checks passed!"
exit 0
